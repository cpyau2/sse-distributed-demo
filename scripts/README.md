# Scripts è…³æœ¬èªªæ˜

## ğŸ“ è…³æœ¬ç¸½è¦½

ç¶“éæ•´ç†å¾Œçš„è…³æœ¬çµæ§‹ï¼Œæ”¯æ´ **HTTP** å’Œ **HTTPS** é›™æ¨¡å¼ï¼Œè‡ªå‹•æª¢æ¸¬ä¸¦é©æ‡‰ç•¶å‰é‹è¡Œçš„ç³»çµ±ã€‚

### ğŸš€ **ä¸»è¦è…³æœ¬**

#### **1. start-servers.bat** - çµ±ä¸€å•Ÿå‹•è…³æœ¬
**åŠŸèƒ½**: ä¸€éµå•Ÿå‹•æœå‹™å™¨ï¼Œæ”¯æ´å¤šç¨®æ¨¡å¼é¸æ“‡
```bash
1) HTTPæ¨¡å¼    - ç«¯å£: 80, 8080/8081/8082, 3000
2) HTTPSæ¨¡å¼   - ç«¯å£: 443, 8443/8444/8445, 3443 (æ¨è–¦)
3) é–‹ç™¼æ¨¡å¼    - å–®å¯¦ä¾‹: 8080, å‰ç«¯: 5173
```

**ä½¿ç”¨æ–¹æ³•**:
```bash
cd scripts
start-servers.bat
# é¸æ“‡æ¨¡å¼ 1, 2, æˆ– 3
```

---

#### **2. stop-all-servers.bat** - åœæ­¢æ‰€æœ‰æœå‹™
**åŠŸèƒ½**: å®Œå…¨åœæ­¢æ‰€æœ‰ç›¸é—œæœå‹™
- âœ… åœæ­¢ Docker å®¹å™¨
- âœ… çµ‚æ­¢ Java é€²ç¨‹
- âœ… çµ‚æ­¢ Node.js é€²ç¨‹
- âœ… é¡¯ç¤ºæ¸…ç†çµæœ

**ä½¿ç”¨æ–¹æ³•**:
```bash
stop-all-servers.bat
```

---

### ğŸ§ª **å°ˆé …æ¸¬è©¦è…³æœ¬**

#### **3. test-http2.bat** - HTTP/2 å°ˆé …æ¸¬è©¦
**åŠŸèƒ½**: å°ˆé–€æ¸¬è©¦ HTTP/2 å”è­°æ”¯æ´
- âœ… HTTP/2 å”è­°æª¢æ¸¬
- âœ… å¤šè·¯å¾©ç”¨é©—è­‰
- âœ… æ€§èƒ½æ¯”è¼ƒ (HTTP/2 vs HTTP/1.1)
- âœ… SSE over HTTP/2 æ¸¬è©¦

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ç¢ºä¿ HTTPS æ¨¡å¼é‹è¡Œ
start-servers.bat â†’ é¸æ“‡ 2
# ç„¶å¾Œæ¸¬è©¦
test-http2.bat
```

---

#### **4. test-distribution.bat** - åˆ†æ•£å¼åŠŸèƒ½æ¸¬è©¦
**åŠŸèƒ½**: æ¸¬è©¦åˆ†æ•£å¼è¨Šæ¯åˆ†ç™¼åŠŸèƒ½
- âœ… è‡ªå‹•æª¢æ¸¬ HTTP/HTTPS æ¨¡å¼
- âœ… å»£æ’­è¨Šæ¯æ¸¬è©¦
- âœ… è² è¼‰å‡è¡¡é©—è­‰
- âœ… ä¼ºæœå™¨é–“é€šè¨Šæ¸¬è©¦

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ä»»ä¸€æ¨¡å¼é‹è¡Œå¾Œ
test-distribution.bat
```

---

### ğŸ”§ **å·¥å…·è…³æœ¬**

#### **5. monitor-servers.bat** - ç³»çµ±ç›£æ§
**åŠŸèƒ½**: å¯¦æ™‚ç›£æ§ç³»çµ±ç‹€æ…‹
- âœ… è‡ªå‹•æª¢æ¸¬é‹è¡Œæ¨¡å¼
- âœ… æœå‹™å¥åº·ç‹€æ…‹ç›£æ§
- âœ… ç³»çµ±æŒ‡æ¨™é¡¯ç¤º
- âœ… Docker å®¹å™¨ç‹€æ…‹
- âœ… æ¯10ç§’è‡ªå‹•åˆ·æ–°

**ä½¿ç”¨æ–¹æ³•**:
```bash
monitor-servers.bat
# Ctrl+C åœæ­¢ç›£æ§
```

---

#### **6. generate-ssl-certs.bat** - SSL è­‰æ›¸ç”Ÿæˆ
**åŠŸèƒ½**: ç”Ÿæˆ HTTPS æ‰€éœ€çš„ SSL è­‰æ›¸
- âœ… ç”Ÿæˆ Nginx SSL è­‰æ›¸ (server.key, server.crt)
- âœ… ç”Ÿæˆ Spring Boot Keystore (keystore.p12)  
- âœ… è‡ªå‹•é…ç½®è­‰æ›¸è·¯å¾‘
- âœ… æ”¯æ´ OpenSSL å’Œ Java keytool

**ä½¿ç”¨æ–¹æ³•**:
```bash
generate-ssl-certs.bat
```

**âš ï¸ é‡è¦**: é‹è¡Œ `docker-compose-prod.yml` (HTTPSæ¨¡å¼) å‰å¿…é ˆå…ˆåŸ·è¡Œæ­¤è…³æœ¬ï¼

---

#### **6.1 generate-ssl-docker.bat** - Docker ç‰ˆ SSL è­‰æ›¸ç”Ÿæˆ
**åŠŸèƒ½**: ä½¿ç”¨ Docker å®¹å™¨ç”Ÿæˆ SSL è­‰æ›¸ï¼ˆæ¨è–¦ï¼‰
- âœ… ä½¿ç”¨ alpine/openssl é¡åƒç”Ÿæˆ Nginx è­‰æ›¸
- âœ… ä½¿ç”¨ openjdk:21-jdk é¡åƒç”Ÿæˆ Spring Boot Keystore
- âœ… ç„¡éœ€æœ¬åœ°å®‰è£ OpenSSL æˆ– Java
- âœ… è·¨å¹³å°å…¼å®¹æ€§æ›´å¥½

**ä½¿ç”¨æ–¹æ³•**:
```bash
generate-ssl-docker.bat
```

**å„ªå‹¢**: 
- ğŸ³ ç´” Docker æ–¹æ¡ˆï¼Œç„¡éœ€æœ¬åœ°å·¥å…·
- ğŸ”„ è‡ªå‹•æ¸…ç†èˆŠè­‰æ›¸
- âœ… å®Œå…¨è‡ªå‹•åŒ–éç¨‹

---

#### **7. redis-management.bat** - Redis ç®¡ç†å·¥å…·
**åŠŸèƒ½**: Redis è³‡æ–™åº«ç®¡ç†æ“ä½œ
- âœ… å•Ÿå‹•/åœæ­¢ Redis
- âœ… æ¸…ç†è³‡æ–™
- âœ… ç›£æ§é€£æ¥

**ä½¿ç”¨æ–¹æ³•**:
```bash
redis-management.bat
```

---

### ğŸ› ï¸ **ä¿®å¾©å·¥å…·**

#### **8. Fix-ChineseDisplay.ps1** - PowerShell ä¸­æ–‡ä¿®å¾©
**åŠŸèƒ½**: PowerShell ä¸­æ–‡é¡¯ç¤ºå•é¡Œä¿®å¾© (PowerShellç‰ˆæœ¬)
- âœ… UTF-8 ç·¨ç¢¼è¨­ç½®
- âœ… è‡ªå‹•é…ç½® PowerShell é…ç½®æ–‡ä»¶
- âœ… æ°¸ä¹…ä¿®å¾©ä¸­æ–‡é¡¯ç¤º

**ä½¿ç”¨æ–¹æ³•**:
```powershell
.\Fix-ChineseDisplay.ps1
```

---

## ğŸ³ **Docker Compose é…ç½®**

é …ç›®ç¾åœ¨ä½¿ç”¨ç°¡åŒ–çš„é›™é…ç½®çµæ§‹ï¼š

### **ğŸ”· docker-compose.yml** (é–‹ç™¼ç’°å¢ƒ)
- **å”è­°**: HTTP
- **ç”¨é€”**: é–‹ç™¼å’Œæ¸¬è©¦
- **ç‰¹é»**: å¿«é€Ÿå•Ÿå‹•ï¼Œç„¡éœ€SSLè­‰æ›¸

```bash
docker-compose up -d
```

### **ğŸ”¶ docker-compose-prod.yml** (ç”Ÿç”¢ç’°å¢ƒ)  
- **å”è­°**: HTTPS + HTTP/2
- **ç”¨é€”**: ç”Ÿç”¢ç’°å¢ƒå’Œæ€§èƒ½æ¸¬è©¦
- **ç‰¹é»**: å®Œæ•´å®‰å…¨é…ç½®ã€Rediså¯†ç¢¼ä¿è­·ã€æ•¸æ“šæŒä¹…åŒ–
- **å‰ç½®æ¢ä»¶**: å¿…é ˆå…ˆé‹è¡Œ `generate-ssl-certs.bat`

```bash
# å…ˆç”ŸæˆSSLè­‰æ›¸
scripts\generate-ssl-certs.bat
# ç„¶å¾Œå•Ÿå‹•ç”Ÿç”¢ç’°å¢ƒ
docker-compose -f docker-compose-prod.yml up -d
```

---

## ğŸ¯ **ä½¿ç”¨æµç¨‹å»ºè­°**

### **é¦–æ¬¡éƒ¨ç½² (HTTPS ç”Ÿç”¢ç’°å¢ƒ)**
```bash
1. scripts\generate-ssl-certs.bat        # ç”ŸæˆSSLè­‰æ›¸
2. docker-compose -f docker-compose-prod.yml up -d  # å•Ÿå‹•ç”Ÿç”¢ç’°å¢ƒ  
3. scripts\test-http2.bat               # é©—è­‰HTTP/2æ”¯æ´
4. scripts\test-distribution.bat        # æ¸¬è©¦åˆ†æ•£å¼åŠŸèƒ½
```

### **å¿«é€Ÿé–‹ç™¼ (HTTP é–‹ç™¼ç’°å¢ƒ)**
```bash
1. docker-compose up -d                 # å•Ÿå‹•é–‹ç™¼ç’°å¢ƒ
2. scripts\monitor-servers.bat          # å¯¦æ™‚ç›£æ§ (å¯é¸)
3. scripts\test-distribution.bat        # æ¸¬è©¦åŠŸèƒ½
4. scripts\stop-all-servers.bat         # é–‹ç™¼å®Œæˆå¾Œåœæ­¢
```

### **åŠŸèƒ½æ¸¬è©¦**
```bash
1. scripts\test-distribution.bat        # æ¸¬è©¦åˆ†æ•£å¼åŠŸèƒ½
2. scripts\test-http2.bat              # æ¸¬è©¦HTTP/2 (åƒ…HTTPSæ¨¡å¼)
3. scripts\monitor-servers.bat         # å¯¦æ™‚ç›£æ§ç³»çµ±ç‹€æ…‹
```

---

## ğŸ“Š **è…³æœ¬ç‰¹æ€§**

### **ğŸ”„ è‡ªå‹•é©æ‡‰**
- æ‰€æœ‰æ¸¬è©¦è…³æœ¬è‡ªå‹•æª¢æ¸¬ HTTP/HTTPS æ¨¡å¼
- æ ¹æ“šæª¢æ¸¬çµæœä½¿ç”¨å°æ‡‰çš„ç«¯å£å’Œå”è­°
- ç„¡éœ€æ‰‹å‹•é…ç½®ï¼Œæ™ºèƒ½é¸æ“‡æ¸¬è©¦åƒæ•¸

### **ğŸ›¡ï¸ éŒ¯èª¤è™•ç†**
- å®Œå–„çš„æœå‹™å¯ç”¨æ€§æª¢æ¸¬
- æ¸…æ™°çš„éŒ¯èª¤è¨Šæ¯å’Œå»ºè­°
- å„ªé›…çš„é€€å‡ºå’Œæ¸…ç†æ©Ÿåˆ¶

### **ğŸ“ è©³ç´°è¼¸å‡º**
- å½©è‰²ç‹€æ…‹æŒ‡ç¤º (âœ…âŒâš ï¸)
- åˆ†æ­¥é©ŸåŸ·è¡Œå ±å‘Š
- æ¸…æ™°çš„çµæœç¸½çµ

### **ğŸ® ä½¿ç”¨è€…å‹å–„**
- ä¸­æ–‡ç•Œé¢å’Œæç¤º
- äº’å‹•å¼é¸æ“‡é¸å–®
- è©³ç´°çš„æ“ä½œæŒ‡å¼•

---

## ğŸ‰ **æœ€è¿‘æ›´æ–°**

### **âœ… é …ç›®çµæ§‹å„ªåŒ– (2024)**
- **æ•´åˆ Docker Compose**: å¾3å€‹é…ç½®æ–‡ä»¶ç°¡åŒ–ç‚º2å€‹
  - ç§»é™¤: `docker-compose-http2.yml`, `docker-compose-redis-secure.yml`
  - ä¿ç•™: `docker-compose.yml` (é–‹ç™¼), `docker-compose-prod.yml` (ç”Ÿç”¢)
- **åˆªé™¤é‡è¤‡è…³æœ¬**: ç§»é™¤é‡è¤‡çš„ä¸­æ–‡ä¿®å¾©è…³æœ¬
- **çµ±ä¸€è­‰æ›¸ç®¡ç†**: `generate-ssl-certs.bat` ç‚ºHTTPSæ¨¡å¼çš„å”¯ä¸€è­‰æ›¸å·¥å…·

### **ğŸ”’ å®‰å…¨å¢å¼·**  
- **ç”Ÿç”¢ç’°å¢ƒ**: Rediså¯†ç¢¼ä¿è­·ã€æ•¸æ“šæŒä¹…åŒ–
- **SSLè­‰æ›¸**: è‡ªå‹•ç”ŸæˆNginxå’ŒSpring Bootæ‰€éœ€è­‰æ›¸
- **HTTP/2æ”¯æ´**: å®Œæ•´çš„HTTP/2å”è­°å¯¦ç¾

---

## ğŸ’¡ **æŠ€è¡“ç‰¹é»**

- **å”è­°è‡ªé©æ‡‰**: è‡ªå‹•æª¢æ¸¬ä¸¦é©é… HTTP/HTTPS
- **æ™ºèƒ½ç«¯å£é¸æ“‡**: æ ¹æ“šå”è­°é¸æ“‡å°æ‡‰ç«¯å£
- **çµ±ä¸€ä»‹é¢**: æ‰€æœ‰è…³æœ¬ä½¿ç”¨ä¸€è‡´çš„æ“ä½œæ–¹å¼
- **å®Œæ•´æ¸¬è©¦è¦†è“‹**: æ¶µè“‹é€£æ¥ã€åŠŸèƒ½ã€æ€§èƒ½æ¸¬è©¦
- **å¯¦æ™‚ç›£æ§**: æ”¯æŒæŒçºŒç›£æ§ç³»çµ±ç‹€æ…‹
- **é›™ç’°å¢ƒæ”¯æ´**: é–‹ç™¼ç’°å¢ƒ (HTTP) + ç”Ÿç”¢ç’°å¢ƒ (HTTPS)

---

**ğŸ‰ ä½¿ç”¨æ•´ç†å¾Œçš„è…³æœ¬ï¼Œäº«å—æ›´ç°¡æ½”é«˜æ•ˆçš„é–‹ç™¼é«”é©—ï¼** 